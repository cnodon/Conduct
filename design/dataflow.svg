<svg width="900" height="1000" xmlns="http://www.w3.org/2000/svg">
  <!-- 背景 -->
  <rect width="900" height="1000" fill="#f5f5f5"/>

  <!-- 标题 -->
  <text x="450" y="40" font-family="Arial, sans-serif" font-size="24" fill="#262626" font-weight="bold" text-anchor="middle">
    数据流程图
  </text>

  <!-- 定义箭头 -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#1890ff"/>
    </marker>
  </defs>

  <!-- 1. 启动 -->
  <ellipse cx="450" cy="100" rx="100" ry="40" fill="#52c41a" stroke="#237804" stroke-width="2"/>
  <text x="450" y="100" font-family="Arial, sans-serif" font-size="16" fill="white" font-weight="bold" text-anchor="middle">启动应用</text>
  <text x="450" y="118" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">conduct gui</text>

  <!-- 箭头 1->2 -->
  <line x1="450" y1="140" x2="450" y2="180" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 2. Location Resolver -->
  <rect x="300" y="180" width="300" height="80" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="6"/>
  <text x="450" y="210" font-family="Arial, sans-serif" font-size="15" fill="#0050b3" font-weight="bold" text-anchor="middle">
    Location Resolver
  </text>
  <text x="450" y="230" font-family="Arial, sans-serif" font-size="12" fill="#595959" text-anchor="middle">
    解析所有 Skills 位置
  </text>
  <text x="450" y="248" font-family="Arial, sans-serif" font-size="11" fill="#8c8c8c" text-anchor="middle">
    个人全局 | 项目级 | 嵌套 | 插件
  </text>

  <!-- 箭头 2->3 -->
  <line x1="450" y1="260" x2="450" y2="300" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 3. Scanner -->
  <rect x="300" y="300" width="300" height="80" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="6"/>
  <text x="450" y="330" font-family="Arial, sans-serif" font-size="15" fill="#0050b3" font-weight="bold" text-anchor="middle">
    Scanner
  </text>
  <text x="450" y="350" font-family="Arial, sans-serif" font-size="12" fill="#595959" text-anchor="middle">
    扫描所有位置
  </text>
  <text x="450" y="368" font-family="Arial, sans-serif" font-size="11" fill="#8c8c8c" text-anchor="middle">
    查找 SKILL.md 文件和支持文件
  </text>

  <!-- 箭头 3->4 -->
  <line x1="450" y1="380" x2="450" y2="420" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 4. Parser -->
  <rect x="300" y="420" width="300" height="80" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="6"/>
  <text x="450" y="450" font-family="Arial, sans-serif" font-size="15" fill="#0050b3" font-weight="bold" text-anchor="middle">
    Parser
  </text>
  <text x="450" y="470" font-family="Arial, sans-serif" font-size="12" fill="#595959" text-anchor="middle">
    解析 SKILL.md 文件
  </text>
  <text x="450" y="488" font-family="Arial, sans-serif" font-size="11" fill="#8c8c8c" text-anchor="middle">
    提取 YAML frontmatter 和内容
  </text>

  <!-- 箭头 4->5 -->
  <line x1="450" y1="500" x2="450" y2="540" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 5. Validator -->
  <rect x="300" y="540" width="300" height="80" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="6"/>
  <text x="450" y="570" font-family="Arial, sans-serif" font-size="15" fill="#0050b3" font-weight="bold" text-anchor="middle">
    Validator
  </text>
  <text x="450" y="590" font-family="Arial, sans-serif" font-size="12" fill="#595959" text-anchor="middle">
    验证配置有效性
  </text>
  <text x="450" y="608" font-family="Arial, sans-serif" font-size="11" fill="#8c8c8c" text-anchor="middle">
    检查必需字段、格式、引用等
  </text>

  <!-- 箭头 5->6 -->
  <line x1="450" y1="620" x2="450" y2="660" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 6. Conflict Analyzer -->
  <rect x="300" y="660" width="300" height="80" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="6"/>
  <text x="450" y="690" font-family="Arial, sans-serif" font-size="15" fill="#0050b3" font-weight="bold" text-anchor="middle">
    Conflict Analyzer
  </text>
  <text x="450" y="710" font-family="Arial, sans-serif" font-size="12" fill="#595959" text-anchor="middle">
    分析优先级和冲突
  </text>
  <text x="450" y="728" font-family="Arial, sans-serif" font-size="11" fill="#8c8c8c" text-anchor="middle">
    识别同名 Skills 覆盖关系
  </text>

  <!-- 箭头 6->7 -->
  <line x1="450" y1="740" x2="450" y2="780" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 7. Tree Data Builder -->
  <rect x="300" y="780" width="300" height="80" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="6"/>
  <text x="450" y="810" font-family="Arial, sans-serif" font-size="15" fill="#0050b3" font-weight="bold" text-anchor="middle">
    Tree Data Builder
  </text>
  <text x="450" y="830" font-family="Arial, sans-serif" font-size="12" fill="#595959" text-anchor="middle">
    构建树形数据结构
  </text>
  <text x="450" y="848" font-family="Arial, sans-serif" font-size="11" fill="#8c8c8c" text-anchor="middle">
    生成层级化的 Skills 树
  </text>

  <!-- 箭头 7->8 -->
  <line x1="450" y1="860" x2="450" y2="900" stroke="#1890ff" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- 8. GUI 渲染 -->
  <ellipse cx="450" cy="940" rx="120" ry="40" fill="#722ed1" stroke="#531dab" stroke-width="2"/>
  <text x="450" y="940" font-family="Arial, sans-serif" font-size="16" fill="white" font-weight="bold" text-anchor="middle">GUI 界面渲染</text>
  <text x="450" y="958" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">显示 Skills 树和详情</text>

  <!-- 侧边注释 -->
  <text x="50" y="220" font-family="Arial, sans-serif" font-size="12" fill="#8c8c8c">步骤 1</text>
  <text x="50" y="340" font-family="Arial, sans-serif" font-size="12" fill="#8c8c8c">步骤 2</text>
  <text x="50" y="460" font-family="Arial, sans-serif" font-size="12" fill="#8c8c8c">步骤 3</text>
  <text x="50" y="580" font-family="Arial, sans-serif" font-size="12" fill="#8c8c8c">步骤 4</text>
  <text x="50" y="700" font-family="Arial, sans-serif" font-size="12" fill="#8c8c8c">步骤 5</text>
  <text x="50" y="820" font-family="Arial, sans-serif" font-size="12" fill="#8c8c8c">步骤 6</text>

  <!-- 右侧实时更新流程 -->
  <rect x="700" y="180" width="180" height="680" fill="#fff7e6" stroke="#fa8c16" stroke-width="2" rx="6" stroke-dasharray="5,5"/>
  <text x="790" y="210" font-family="Arial, sans-serif" font-size="14" fill="#d46b08" font-weight="bold" text-anchor="middle">
    实时更新循环
  </text>

  <!-- 文件监听 -->
  <rect x="720" y="230" width="140" height="60" fill="#ffe7ba" stroke="#fa8c16" stroke-width="1" rx="4"/>
  <text x="790" y="255" font-family="Arial, sans-serif" font-size="12" fill="#d46b08" font-weight="bold" text-anchor="middle">
    File Watcher
  </text>
  <text x="790" y="273" font-family="Arial, sans-serif" font-size="10" fill="#8c8c8c" text-anchor="middle">
    监听文件变更
  </text>

  <!-- 箭头 -->
  <path d="M 790 290 Q 790 320, 820 340" stroke="#fa8c16" stroke-width="2" fill="none" marker-end="url(#arroworange)"/>
  <text x="810" y="320" font-family="Arial, sans-serif" font-size="10" fill="#d46b08">检测到变更</text>

  <!-- 触发重新扫描 -->
  <rect x="720" y="340" width="140" height="60" fill="#ffe7ba" stroke="#fa8c16" stroke-width="1" rx="4"/>
  <text x="790" y="365" font-family="Arial, sans-serif" font-size="12" fill="#d46b08" font-weight="bold" text-anchor="middle">
    重新扫描
  </text>
  <text x="790" y="383" font-family="Arial, sans-serif" font-size="10" fill="#8c8c8c" text-anchor="middle">
    触发步骤 2-6
  </text>

  <!-- 箭头 -->
  <path d="M 790 400 Q 790 430, 820 460" stroke="#fa8c16" stroke-width="2" fill="none" marker-end="url(#arroworange)"/>

  <!-- 更新 UI -->
  <rect x="720" y="460" width="140" height="60" fill="#ffe7ba" stroke="#fa8c16" stroke-width="1" rx="4"/>
  <text x="790" y="485" font-family="Arial, sans-serif" font-size="12" fill="#d46b08" font-weight="bold" text-anchor="middle">
    更新 UI
  </text>
  <text x="790" y="503" font-family="Arial, sans-serif" font-size="10" fill="#8c8c8c" text-anchor="middle">
    刷新界面显示
  </text>

  <!-- 循环箭头 -->
  <path d="M 720 490 Q 680 490, 680 260 Q 680 240, 720 240" stroke="#fa8c16" stroke-width="2" fill="none" marker-end="url(#arroworange)" stroke-dasharray="3,3"/>
  <text x="650" y="370" font-family="Arial, sans-serif" font-size="10" fill="#d46b08" transform="rotate(-90 650 370)">
    继续监听
  </text>

  <defs>
    <marker id="arroworange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#fa8c16"/>
    </marker>
  </defs>
</svg>
